<!-- Webflow Embed Code for Photo Galleries Template -->
<!-- Replace the existing embed code with this updated version -->

<div id="gallery-wrapper" style="width:100%;min-height:600px">
  <iframe
    id="lot43-gallery"
    style="width:100%;border:none;min-height:800px"
    loading="lazy"
  ></iframe>
</div>

<script>
  // Set iframe source based on URL slug
  var slug = window.location.pathname.split("/").pop();
  document.getElementById("lot43-gallery").src =
    "https://dustchambers.github.io/beltline-app-gallery/gallery.html?id=" + slug;

  // Saved iframe styles to restore after lightbox closes
  var savedStyles = {};

  window.addEventListener("message", function(e) {
    var iframe = document.getElementById("lot43-gallery");

    // Handle resize messages - update iframe height to match content
    if (e.data && e.data.type === "resize") {
      iframe.style.height = e.data.height + "px";
    }

    // Lightbox opening - make iframe fullscreen over entire page
    if (e.data && e.data.type === "lightbox-open") {
      savedStyles = {
        position: iframe.style.position,
        top: iframe.style.top,
        left: iframe.style.left,
        width: iframe.style.width,
        height: iframe.style.height,
        zIndex: iframe.style.zIndex,
        scrollY: window.scrollY
      };
      iframe.style.position = "fixed";
      iframe.style.top = "0";
      iframe.style.left = "0";
      iframe.style.width = "100vw";
      iframe.style.height = "100vh";
      iframe.style.zIndex = "999999";
    }

    // Lightbox closing - restore iframe to normal flow
    if (e.data && e.data.type === "lightbox-close") {
      iframe.style.position = savedStyles.position || "";
      iframe.style.top = savedStyles.top || "";
      iframe.style.left = savedStyles.left || "";
      iframe.style.width = savedStyles.width || "";
      iframe.style.height = savedStyles.height || "";
      iframe.style.zIndex = savedStyles.zIndex || "";
      window.scrollTo(0, savedStyles.scrollY || 0);
    }
  });
</script>
